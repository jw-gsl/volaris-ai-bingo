<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Adoption Bingo - Volaris Business Transformation</title>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* ===== CSS Custom Properties ===== */
        :root {
            --navy: #0B2340;
            --lime: #BFD731;
            --teal: #008AB0;
            --dark-gray: #464646;
            --off-white: #FAF9F6;
            --white: #ffffff;
            --bg: var(--off-white);
            --card-bg: var(--white);
            --text: var(--dark-gray);
            --heading: var(--navy);
            --cell-bg: var(--white);
            --cell-border: var(--navy);
            --cell-text: var(--navy);
            --marked-bg: var(--lime);
            --marked-text: var(--navy);
            --free-bg: var(--lime);
            --overlay-bg: rgba(11, 35, 64, 0.92);
            --shadow: rgba(11, 35, 64, 0.12);
            --shadow-strong: rgba(11, 35, 64, 0.25);
            --toast-bg: var(--navy);
            --toast-text: var(--white);
            --toggle-bg: #d1d5db;
            --toggle-active: var(--teal);
            --footer-bg: rgba(11, 35, 64, 0.06);
            --footer-text: var(--dark-gray);
            --rebuttal-bg: var(--navy);
            --rebuttal-text: var(--white);
            --bingo-row-glow: rgba(191, 215, 49, 0.5);
        }

        [data-theme="dark"] {
            --bg: #0f1729;
            --card-bg: #1a2744;
            --text: #d1d5db;
            --heading: var(--off-white);
            --cell-bg: #1e2d4a;
            --cell-border: #2a3f66;
            --cell-text: var(--off-white);
            --marked-bg: #4a6b0a;
            --marked-text: var(--off-white);
            --free-bg: #4a6b0a;
            --overlay-bg: rgba(15, 23, 41, 0.95);
            --shadow: rgba(0, 0, 0, 0.3);
            --shadow-strong: rgba(0, 0, 0, 0.5);
            --toast-bg: var(--lime);
            --toast-text: var(--navy);
            --toggle-bg: #374151;
            --footer-bg: rgba(255, 255, 255, 0.05);
            --footer-text: #9ca3af;
            --rebuttal-bg: #0d1b30;
            --rebuttal-text: var(--off-white);
            --bingo-row-glow: rgba(191, 215, 49, 0.3);
        }

        /* ===== Reset & Base ===== */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Barlow', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
            transition: background 0.3s ease, color 0.3s ease;
            -webkit-font-smoothing: antialiased;
        }

        /* ===== Layout ===== */
        .container {
            max-width: 820px;
            margin: 0 auto;
        }

        /* ===== Header ===== */
        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .logo-area {
            margin-bottom: 12px;
        }

        .logo-area img {
            height: 40px;
            width: auto;
            transition: filter 0.3s;
        }

        [data-theme="dark"] .logo-area img {
            filter: brightness(0) invert(1);
        }

        .logo-subtitle {
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--teal);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 4px;
        }

        .title {
            font-weight: 900;
            font-size: clamp(1.6rem, 5vw, 2.4rem);
            color: var(--heading);
            line-height: 1.1;
            margin-bottom: 4px;
            letter-spacing: -0.5px;
        }

        .tagline {
            font-size: 0.85rem;
            color: var(--text);
            opacity: 0.8;
            font-style: italic;
        }

        /* ===== Controls Bar ===== */
        .controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 16px;
            font-size: 0.8rem;
        }

        .toggle-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .toggle-label {
            font-weight: 600;
            font-size: 0.75rem;
            color: var(--text);
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            user-select: none;
        }

        .toggle-label.active {
            opacity: 1;
            color: var(--teal);
        }

        .toggle-switch {
            position: relative;
            width: 36px;
            height: 20px;
            cursor: pointer;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            inset: 0;
            background: var(--toggle-bg);
            border-radius: 20px;
            transition: background 0.3s;
        }

        .toggle-slider::before {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            left: 2px;
            bottom: 2px;
            background: var(--white);
            border-radius: 50%;
            transition: transform 0.3s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .toggle-switch input:checked + .toggle-slider {
            background: var(--toggle-active);
        }

        .toggle-switch input:checked + .toggle-slider::before {
            transform: translateX(16px);
        }

        /* ===== Card Info Bar ===== */
        .card-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 0 2px;
        }

        .card-id {
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text);
            opacity: 0.5;
            font-family: monospace;
        }

        .score {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--teal);
        }

        /* ===== Bingo Card ===== */
        .bingo-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 24px var(--shadow), 0 1px 4px var(--shadow);
            transition: background 0.3s ease;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
        }

        /* ===== Bingo Cell ===== */
        .cell {
            aspect-ratio: 1 / 1.15;
            border: 2px solid var(--cell-border);
            border-radius: 8px;
            background: var(--cell-bg);
            cursor: pointer;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px 6px;
            text-align: center;
            transition: transform 0.15s ease, background 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
            user-select: none;
            outline: none;
        }

        .cell:hover {
            transform: scale(1.03);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .cell:active {
            transform: scale(0.97);
        }

        .cell:focus-visible {
            outline: 3px solid var(--teal);
            outline-offset: 2px;
        }

        .cell .excuse-text {
            font-size: clamp(0.62rem, 1.8vw, 1rem);
            font-weight: 600;
            color: var(--cell-text);
            line-height: 1.3;
            z-index: 2;
            transition: opacity 0.3s ease;
            word-break: break-word;
            hyphens: auto;
        }

        /* Marked state */
        .cell.marked {
            background: var(--marked-bg);
            border-color: var(--marked-bg);
        }

        .cell.marked .excuse-text {
            color: var(--marked-text);
        }

        .cell.marked .stamp-icon {
            opacity: 1;
        }

        /* Stamp animation */
        .cell.stamp-animate {
            animation: stampPop 0.35s ease;
        }

        @keyframes stampPop {
            0% { transform: scale(1); }
            30% { transform: scale(0.88); }
            60% { transform: scale(1.08); }
            100% { transform: scale(1); }
        }

        .stamp-icon {
            position: absolute;
            top: 3px;
            right: 3px;
            width: 14px;
            height: 14px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 3;
        }

        .stamp-icon svg {
            width: 100%;
            height: 100%;
            fill: var(--marked-text);
            opacity: 0.4;
        }

        /* Info button */
        .info-btn {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: none;
            background: var(--teal);
            color: var(--white);
            font-family: 'Barlow', sans-serif;
            font-size: 0.6rem;
            font-weight: 800;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.5;
            transition: opacity 0.2s, transform 0.15s;
            z-index: 5;
            padding: 0;
            line-height: 1;
        }

        .info-btn:hover, .info-btn:focus-visible {
            opacity: 1;
            transform: scale(1.15);
        }

        .cell.marked .info-btn {
            background: var(--navy);
            color: var(--white);
            opacity: 0.6;
        }

        .cell.marked .info-btn:hover {
            opacity: 1;
        }

        /* Free space */
        .cell.free-space {
            background: var(--free-bg);
            border-color: var(--free-bg);
        }

        .cell.free-space .excuse-text {
            font-weight: 800;
            color: var(--navy);
        }

        .cell.free-space .info-btn {
            display: none;
        }

        /* Bingo row highlight */
        .cell.bingo-cell {
            box-shadow: 0 0 12px var(--bingo-row-glow), 0 0 24px var(--bingo-row-glow);
            animation: bingoGlow 1.5s ease-in-out infinite alternate;
        }

        @keyframes bingoGlow {
            from { box-shadow: 0 0 8px var(--bingo-row-glow); }
            to { box-shadow: 0 0 20px var(--bingo-row-glow), 0 0 40px var(--bingo-row-glow); }
        }

        /* ===== Rebuttal Modal ===== */
        .rebuttal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: var(--overlay-bg);
            z-index: 100;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.2s ease;
        }

        .rebuttal-overlay.show {
            display: flex;
        }

        .rebuttal-card {
            background: var(--rebuttal-bg);
            border-radius: 16px;
            padding: 32px;
            max-width: 420px;
            width: 100%;
            text-align: center;
            position: relative;
            animation: slideUp 0.3s ease;
        }

        .rebuttal-excuse {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--lime);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 16px;
            opacity: 0.8;
        }

        .rebuttal-text {
            font-size: 1.15rem;
            font-weight: 500;
            color: var(--rebuttal-text);
            line-height: 1.5;
            margin-bottom: 24px;
        }

        .rebuttal-close {
            background: var(--lime);
            color: var(--navy);
            border: none;
            padding: 10px 28px;
            border-radius: 8px;
            font-family: 'Barlow', sans-serif;
            font-size: 0.85rem;
            font-weight: 700;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .rebuttal-close:hover {
            opacity: 0.85;
        }

        /* ===== Action Buttons ===== */
        .actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 16px;
        }

        .btn {
            font-family: 'Barlow', sans-serif;
            font-size: 0.8rem;
            font-weight: 700;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.15s ease, opacity 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover { opacity: 0.88; }
        .btn:active { transform: scale(0.96); }

        .btn-primary {
            background: var(--teal);
            color: var(--white);
        }

        .btn-secondary {
            background: var(--navy);
            color: var(--white);
        }

        .btn-accent {
            background: var(--lime);
            color: var(--navy);
        }

        /* ===== BINGO Celebration Overlay ===== */
        .bingo-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: var(--overlay-bg);
            z-index: 200;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 16px;
            animation: fadeIn 0.3s ease;
        }

        .bingo-overlay.show {
            display: flex;
        }

        .bingo-title {
            font-size: clamp(4rem, 15vw, 8rem);
            font-weight: 900;
            color: var(--lime);
            letter-spacing: 8px;
            text-shadow: 0 4px 20px rgba(191, 215, 49, 0.4);
            animation: bingoPop 0.6s ease;
        }

        .bingo-subtitle {
            font-size: 1.1rem;
            color: var(--off-white);
            opacity: 0.8;
        }

        .bingo-overlay .btn {
            margin-top: 8px;
        }

        @keyframes bingoPop {
            0% { transform: scale(0.3); opacity: 0; }
            60% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* ===== Confetti Canvas ===== */
        #confettiCanvas {
            position: fixed;
            inset: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 210;
        }

        /* ===== Toast ===== */
        .toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%) translateY(80px);
            background: var(--toast-bg);
            color: var(--toast-text);
            padding: 10px 24px;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            z-index: 300;
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            pointer-events: none;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* ===== Footer / Attribution ===== */
        .footer {
            margin-top: 24px;
            padding: 16px;
            background: var(--footer-bg);
            border-radius: 12px;
            text-align: center;
        }

        .footer-primary {
            font-size: 0.78rem;
            color: var(--footer-text);
            line-height: 1.6;
            margin-bottom: 6px;
        }

        .footer-secondary {
            font-size: 0.68rem;
            color: var(--footer-text);
            opacity: 0.6;
            line-height: 1.6;
        }

        .footer strong {
            font-weight: 700;
        }

        .how-to-play {
            font-size: 0.75rem;
            color: var(--text);
            opacity: 0.7;
            margin-top: 12px;
            line-height: 1.5;
            text-align: center;
        }

        .how-to-play strong {
            color: var(--teal);
        }

        /* ===== Mute Button ===== */
        .mute-btn {
            background: none;
            border: 1.5px solid var(--cell-border);
            border-radius: 6px;
            padding: 3px 8px;
            font-family: 'Barlow', sans-serif;
            font-size: 0.72rem;
            font-weight: 600;
            color: var(--text);
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .mute-btn:hover { opacity: 1; }

        .mute-btn .mute-icon {
            font-size: 0.85rem;
            line-height: 1;
        }

        /* ===== Animations ===== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in { animation: fadeIn 0.4s ease; }
        .slide-down { animation: slideDown 0.4s ease; }

        /* ===== Responsive ===== */
        @media (max-width: 520px) {
            body { padding: 10px; }
            .bingo-card { padding: 8px; }
            .grid { gap: 4px; }
            .cell { padding: 4px 3px; border-width: 1.5px; border-radius: 5px; }
            .cell .excuse-text { font-size: clamp(0.5rem, 3vw, 0.7rem); line-height: 1.2; }
            .actions { gap: 6px; }
            .btn { padding: 8px 14px; font-size: 0.72rem; }
            .controls { gap: 10px; }
            .stamp-icon { width: 10px; height: 10px; top: 1px; right: 1px; }
            .info-btn { width: 15px; height: 15px; font-size: 0.5rem; bottom: 1px; right: 1px; }
        }

        @media (min-width: 521px) and (max-width: 768px) {
            .cell .excuse-text { font-size: clamp(0.6rem, 1.8vw, 0.85rem); }
        }

        /* ===== Print ===== */
        @media print {
            body { background: white; }
            .controls, .actions, .how-to-play { display: none; }
            .bingo-card { box-shadow: none; border: 2px solid var(--navy); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header slide-down">
            <div class="logo-area">
                <img src="https://www.volarisgroup.com/wp-content/uploads/2024/09/Logo-2.png" alt="Volaris Group" id="logoImg">
                <div class="logo-subtitle">Business Transformation</div>
            </div>
            <h1 class="title" id="mainTitle">AI Adoption Bullshit Bingo</h1>
            <p class="tagline" id="tagline">Spot the bullshit. Call it out. Win the meeting.</p>
        </header>

        <!-- Controls -->
        <div class="controls fade-in">
            <div class="toggle-group">
                <span class="toggle-label" id="funLabel">Extreme</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="toneToggle" aria-label="Toggle professional mode">
                    <span class="toggle-slider"></span>
                </label>
                <span class="toggle-label" id="proLabel">Professional</span>
            </div>
            <div class="toggle-group">
                <span class="toggle-label">Light</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="themeToggle" aria-label="Toggle dark mode">
                    <span class="toggle-slider"></span>
                </label>
                <span class="toggle-label">Dark</span>
            </div>
            <button class="mute-btn" id="muteBtn" onclick="toggleMute()" aria-label="Toggle sound">
                <span class="mute-icon" id="muteIcon">&#x1F50A;</span>
                <span id="muteLabel">Sound</span>
            </button>
        </div>

        <!-- Card Info -->
        <div class="card-info fade-in">
            <span class="card-id" id="cardId">Card #0000</span>
            <span class="score" id="scoreDisplay">0 / 25 marked</span>
        </div>

        <!-- Bingo Card -->
        <div class="bingo-card fade-in" id="bingoCard">
            <div class="grid" id="bingoGrid" role="grid" aria-label="Bingo card"></div>
        </div>

        <!-- How to play -->
        <p class="how-to-play fade-in" id="howToPlay">
            <strong>Click</strong> a cell to mark the bullshit when you hear it. Hit the <strong>&#x24D8;</strong> for the comeback. Get <strong>5 in a row</strong> and call BINGO!
        </p>

        <!-- Action Buttons -->
        <div class="actions fade-in">
            <button class="btn btn-primary" onclick="generateNewCard()">New Card</button>
            <button class="btn btn-secondary" onclick="resetMarks()">Reset</button>
            <button class="btn btn-accent" onclick="shareCard()">Share My Card</button>
        </div>

        <!-- Footer -->
        <footer class="footer fade-in">
            <p class="footer-primary">
                Volaris edition by <strong>Volaris Business Transformation</strong> &mdash; powered by <strong>Claude Code</strong>
            </p>
            <p class="footer-secondary">
                Original concept by <strong>Topicus</strong> &amp; <strong>TSS</strong> &rarr; AI adoption version by <strong>Jonas Software</strong>
            </p>
        </footer>
    </div>

    <!-- Rebuttal Modal -->
    <div class="rebuttal-overlay" id="rebuttalOverlay">
        <div class="rebuttal-card">
            <div class="rebuttal-excuse" id="rebuttalExcuse"></div>
            <div class="rebuttal-text" id="rebuttalText"></div>
            <button class="rebuttal-close" onclick="closeRebuttal()">Got it</button>
        </div>
    </div>

    <!-- BINGO Celebration Overlay -->
    <div class="bingo-overlay" id="bingoOverlay">
        <div class="bingo-title" id="bingoTitle">BINGO!</div>
        <div class="bingo-subtitle" id="bingoSubtitle">You found 5 excuses in a row!</div>
        <button class="btn btn-accent" onclick="closeBingo()">View Card</button>
        <button class="btn btn-primary" onclick="closeBingo(); generateNewCard();">New Game</button>
    </div>

    <!-- Confetti Canvas -->
    <canvas id="confettiCanvas"></canvas>

    <!-- Toast -->
    <div class="toast" id="toast">Copied to clipboard!</div>

    <script>
    /* ===================================================================
       VOLARIS AI BINGO - All JavaScript
       =================================================================== */

    // ===== Excuse Pool (50 excuses + rebuttals) =====
    const EXCUSE_POOL = [
        // --- Original 24 ---
        {
            excuse: "Our customers aren't asking for AI",
            rebuttal: "Customers didn't ask for the iPhone either. Your job is to lead, not follow.",
            rebuttalPro: "Customers rarely articulate needs for transformative technology. Leadership means anticipating where value can be created."
        },
        {
            excuse: "Our industry is different",
            rebuttal: "Every industry said that about the internet too. How'd that work out?",
            rebuttalPro: "While each industry has unique characteristics, AI is a general-purpose technology. The question isn't if it applies, but how."
        },
        {
            excuse: "Wait and see what competitors do",
            rebuttal: "By the time you see what they're doing, you'll be 18 months behind.",
            rebuttalPro: "Fast followers in AI adoption have consistently underperformed first movers. The learning curve advantage compounds over time."
        },
        {
            excuse: "Our customers are too traditional",
            rebuttal: "They're using ChatGPT at home. They're not traditional\u2014you're just slow.",
            rebuttalPro: "Consumer AI adoption has outpaced enterprise readiness. Your customers are likely already more comfortable with AI than you expect."
        },
        {
            excuse: "Don't want to be guinea pigs",
            rebuttal: "You won't be. You'll be fossils. Someone's already testing this.",
            rebuttalPro: "The risk of inaction now exceeds the risk of measured experimentation. Structured pilots with clear success criteria minimize exposure."
        },
        {
            excuse: "Don't have the right talent",
            rebuttal: "Your team learned your legacy system. They can learn to prompt Claude.",
            rebuttalPro: "Modern AI tools are designed for business users, not just data scientists. Upskilling existing staff is faster and cheaper than hiring."
        },
        {
            excuse: "Our tech stack is too old",
            rebuttal: "APIs work with COBOL. If your system can call an endpoint, you can use AI.",
            rebuttalPro: "AI integration via APIs is technology-agnostic. Even legacy systems can leverage AI through lightweight middleware layers."
        },
        {
            excuse: "Already at full capacity",
            rebuttal: "Which is exactly why you need AI\u2014to do more with less.",
            rebuttalPro: "Capacity constraints are precisely the problem AI solves. Start with automating the tasks consuming the most bandwidth."
        },
        {
            excuse: "Our data isn't clean enough",
            rebuttal: "AI cleans data. Start with simple use cases, then use AI to fix your data.",
            rebuttalPro: "Many AI applications work with imperfect data. Additionally, AI itself can be used to improve data quality incrementally."
        },
        {
            excuse: "Need to hire an AI team",
            rebuttal: "No, you need to upskill your current team and buy AI subscriptions. Big difference.",
            rebuttalPro: "Building internal AI capability through upskilling is more sustainable than hiring specialists. Start with tool adoption, not team building."
        },
        {
            excuse: "What about hallucinations?",
            rebuttal: "Your junior dev makes mistakes too. You review their work. Same process.",
            rebuttalPro: "AI outputs require human review, just like any other tool output. Establish verification workflows appropriate to the use case risk level."
        },
        {
            excuse: "Legal/compliance risks",
            rebuttal: "Legal already approved email. This is just another tool. Get them involved early.",
            rebuttalPro: "Engage legal and compliance early as partners, not gatekeepers. Many AI providers now offer enterprise-grade compliance frameworks."
        },
        {
            excuse: "Security concerns",
            rebuttal: "SOC 2 compliant AI providers exist. Your current SaaS has the same risks.",
            rebuttalPro: "Enterprise AI platforms meet the same security standards as your existing SaaS tools. Evaluate them with your standard vendor assessment."
        },
        {
            excuse: "Wait for regulations",
            rebuttal: "Regulations will take 5 years. You'll be out of business by then.",
            rebuttalPro: "Regulatory frameworks are being developed alongside adoption. Companies already using AI responsibly will be best positioned when rules arrive."
        },
        {
            excuse: "Focus on core business",
            rebuttal: "AI IS core business now. Every business is becoming an AI business.",
            rebuttalPro: "AI enhances core business operations\u2014it doesn't replace your focus. It's a capability multiplier for what you already do."
        },
        {
            excuse: "Finish current transformation first",
            rebuttal: "Your transformation is obsolete. Would you finish installing fax machines after email?",
            rebuttalPro: "AI should be integrated into your current transformation roadmap, not treated as a separate phase. Parallel execution is possible and preferred."
        },
        {
            excuse: "Need 3-year strategy",
            rebuttal: "AI moves in months, not years. Start with a 90-day experiment.",
            rebuttalPro: "The pace of AI development makes multi-year planning impractical. Adopt an iterative approach with 90-day experimentation cycles."
        },
        {
            excuse: "This is just a fad",
            rebuttal: "Like electricity? Cloud computing? Some 'fads' restructure entire economies.",
            rebuttalPro: "AI represents a fundamental shift in computing capability, comparable to the internet itself. Treating it as a fad creates existential risk."
        },
        {
            excuse: "We tried AI before",
            rebuttal: "You tried mobile in 2003 too. GPT-4 isn't your 2018 chatbot.",
            rebuttalPro: "The AI landscape has transformed dramatically. Modern foundation models deliver capabilities that weren't possible even two years ago."
        },
        {
            excuse: "ROI isn't clear",
            rebuttal: "What's the ROI of becoming irrelevant? Your competitor is stealing your customers.",
            rebuttalPro: "Pilot programs with defined KPIs provide clear ROI evidence. Many companies report 3\u201310x returns on targeted AI investments."
        },
        {
            excuse: "Can't afford investment",
            rebuttal: "AI tools cost $20/employee/month. You can't afford NOT to invest. What's your coffee budget?",
            rebuttalPro: "AI tool costs have dropped dramatically. Many high-impact applications can be deployed for less than traditional software licensing."
        },
        {
            excuse: "Margins too thin",
            rebuttal: "Your margins are thin because you're inefficient. AI fixes efficiency.",
            rebuttalPro: "AI-driven process optimization directly improves margins. Companies with thin margins have the most to gain from efficiency automation."
        },
        {
            excuse: "Need buy-in from others",
            rebuttal: "Show them results, not slide decks. Build a prototype, demonstrate value.",
            rebuttalPro: "Stakeholder buy-in follows demonstrated results. A small proof of concept speaks louder than any business case presentation."
        },
        {
            excuse: "Culture isn't ready",
            rebuttal: "Culture follows results. Ship one AI win and watch your culture shift overnight.",
            rebuttalPro: "Culture change accelerates when people experience benefits firsthand. Start with enthusiastic teams and let success create momentum."
        },
        // --- New 26 excuses ---
        {
            excuse: "What about GDPR / data privacy?",
            rebuttal: "You already handle customer data. Add AI to your existing privacy framework\u2014it's not a new planet.",
            rebuttalPro: "GDPR-compliant AI deployments are standard practice. Apply the same data governance principles you already use."
        },
        {
            excuse: "AI will replace our jobs",
            rebuttal: "AI replaces tasks, not people. The people who use AI will replace those who don't.",
            rebuttalPro: "AI augments human capability. Historically, automation creates more jobs than it displaces by enabling new forms of value creation."
        },
        {
            excuse: "We need more research first",
            rebuttal: "You've been 'researching' for two years. Your competitors shipped last quarter.",
            rebuttalPro: "Applied experimentation generates more actionable insights than extended research. A 30-day pilot will teach you more than six months of analysis."
        },
        {
            excuse: "Our board hasn't approved it",
            rebuttal: "Your board wants growth. Show them a pilot with measurable results, not another slide deck.",
            rebuttalPro: "Frame AI as a competitive necessity in your next board presentation. Most boards are actively seeking AI strategies from management."
        },
        {
            excuse: "Customers won't trust AI",
            rebuttal: "Customers trust GPS, autocorrect, and fraud detection. They already trust AI\u2014they just don't know it.",
            rebuttalPro: "Transparency builds trust. Customers already interact with AI daily. Clear communication about how you use AI actually increases confidence."
        },
        {
            excuse: "We don't have enough data",
            rebuttal: "You have emails, tickets, docs, and transactions. You have plenty. You just haven't looked.",
            rebuttalPro: "Modern AI models work effectively with modest data sets. Pre-trained models bring broad knowledge that requires minimal domain-specific data."
        },
        {
            excuse: "AI is too expensive to maintain",
            rebuttal: "Maintaining legacy manual processes is more expensive. Do the math on your current cost of inefficiency.",
            rebuttalPro: "AI operational costs have decreased by 90% in two years. Cloud-based AI services eliminate most infrastructure maintenance overhead."
        },
        {
            excuse: "Our processes are too complex",
            rebuttal: "Complex processes are AI's superpower. It thrives on the messy stuff humans hate doing.",
            rebuttalPro: "AI excels at navigating complex, multi-step processes. Start by mapping your most complex workflows\u2014those offer the highest automation ROI."
        },
        {
            excuse: "We need to focus on profitability",
            rebuttal: "AI literally improves profitability. That's... the whole point.",
            rebuttalPro: "AI directly impacts profitability through cost reduction and revenue enhancement. It should be a core component of any profitability strategy."
        },
        {
            excuse: "The technology isn't mature enough",
            rebuttal: "GPT-4 passed the bar exam. How mature do you need it to be?",
            rebuttalPro: "Current AI models demonstrate expert-level performance across numerous domains. The technology has reached production-ready maturity for many use cases."
        },
        {
            excuse: "We're too small for AI",
            rebuttal: "A solo freelancer uses AI. A 5-person startup uses AI. 'Too small' doesn't exist anymore.",
            rebuttalPro: "AI tools are now accessible to organizations of every size. Small companies often see disproportionately large productivity gains from AI adoption."
        },
        {
            excuse: "It's not in this year's budget",
            rebuttal: "Neither was that 'urgent' consulting project. Find the money or lose the market.",
            rebuttalPro: "Many AI initiatives can start within existing budgets using pay-as-you-go models. The cost of delay typically exceeds the cost of starting small."
        },
        {
            excuse: "We need an AI strategy first",
            rebuttal: "Your strategy IS to start. You don't need a map to take the first step.",
            rebuttalPro: "Strategy emerges from experimentation. Begin with pilot projects that inform your strategic direction rather than delaying action for perfect planning."
        },
        {
            excuse: "Our vendor doesn't support it",
            rebuttal: "Then your vendor is a liability. Time for a conversation or a replacement.",
            rebuttalPro: "Vendor AI readiness should be part of your evaluation criteria. Engage vendors on their AI roadmap\u2014or explore alternatives that prioritize it."
        },
        {
            excuse: "The team is resistant to change",
            rebuttal: "They were resistant to Slack too. Give them a tool that makes their life easier.",
            rebuttalPro: "Change resistance decreases when the benefits are tangible and personal. Start with tools that save individual contributors time on tedious tasks."
        },
        {
            excuse: "We need to understand it better",
            rebuttal: "You'll understand it by using it. Nobody learned to swim by reading about water.",
            rebuttalPro: "Hands-on experience is the most effective way to build AI literacy. Structured workshops with real business scenarios accelerate understanding."
        },
        {
            excuse: "AI can't handle our edge cases",
            rebuttal: "Your current process can't either. At least AI scales to handle them faster.",
            rebuttalPro: "AI handles pattern-based edge cases well when trained on relevant examples. Human-in-the-loop designs address the rest effectively."
        },
        {
            excuse: "What if it makes a mistake?",
            rebuttal: "What if YOUR team makes a mistake? They do. Weekly. You have processes for that.",
            rebuttalPro: "Error handling for AI follows the same principles as any operational process. Build verification steps proportional to the risk level."
        },
        {
            excuse: "We'll do it next quarter",
            rebuttal: "You said that last quarter. And the quarter before. Your future self is also procrastinating.",
            rebuttalPro: "Quarterly postponement compounds opportunity cost. Every quarter of delay is a quarter your competitors use to build their AI advantage."
        },
        {
            excuse: "Our IT team is overloaded",
            rebuttal: "Most AI tools are SaaS\u2014no IT deployment needed. Your marketing team can start tomorrow.",
            rebuttalPro: "Modern AI tools are business-user-friendly and require minimal IT involvement. SaaS-based solutions can be adopted departmentally."
        },
        {
            excuse: "We need a use case first",
            rebuttal: "You have 50 use cases. Pick the one that wastes the most time every week.",
            rebuttalPro: "Use cases emerge from examining repetitive, time-consuming, or error-prone processes. Most teams identify multiple candidates within one workshop."
        },
        {
            excuse: "What about bias in AI?",
            rebuttal: "Your hiring manager has bias too. AI bias is at least measurable and fixable.",
            rebuttalPro: "AI bias is a legitimate consideration with established mitigation frameworks. Regular auditing and diverse training data reduce bias systematically."
        },
        {
            excuse: "Senior leadership doesn't get it",
            rebuttal: "Senior leadership didn't 'get' the internet in 1995 either. Be the one who shows them.",
            rebuttalPro: "Executive AI literacy is growing rapidly. Champion AI by presenting business outcomes and competitive implications, not technical details."
        },
        {
            excuse: "We're waiting for the next version",
            rebuttal: "There will ALWAYS be a next version. Start now or wait forever.",
            rebuttalPro: "AI capabilities improve continuously. The skills and workflows you build today compound in value with each new model generation."
        },
        {
            excuse: "It works fine the way it is",
            rebuttal: "Blockbuster thought the same thing. Then Netflix happened.",
            rebuttalPro: "Current performance isn't a predictor of future competitiveness. Markets reward organizations that continuously improve, not those that maintain the status quo."
        },
        {
            excuse: "AI output quality isn't good enough",
            rebuttal: "It's better than your first draft. And it takes 10 seconds, not 10 hours.",
            rebuttalPro: "AI output quality improves dramatically with proper prompting and fine-tuning. The speed advantage alone justifies adoption even with human editing."
        }
    ];

    // ===== State =====
    let currentCard = [];
    let markedCells = new Set();
    let cardSeed = 0;
    let bingoDetected = false;
    let isFunMode = true;
    let isDarkMode = false;
    let isMuted = false;

    // ===== Web Audio Sound System =====
    let audioCtx = null;

    function getAudioCtx() {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        return audioCtx;
    }

    function playStampSound() {
        if (isMuted) return;
        try {
            const ctx = getAudioCtx();
            // Short percussive "thwack" sound
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            osc.type = 'square';
            osc.frequency.setValueAtTime(200, ctx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(80, ctx.currentTime + 0.08);
            gain.gain.setValueAtTime(0.15, ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.12);
            osc.start(ctx.currentTime);
            osc.stop(ctx.currentTime + 0.12);
        } catch(e) {}
    }

    function playUnmarkSound() {
        if (isMuted) return;
        try {
            const ctx = getAudioCtx();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            osc.type = 'sine';
            osc.frequency.setValueAtTime(300, ctx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(150, ctx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.08, ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.1);
            osc.start(ctx.currentTime);
            osc.stop(ctx.currentTime + 0.1);
        } catch(e) {}
    }

    function playBingoSound() {
        if (isMuted) return;
        try {
            const ctx = getAudioCtx();
            const notes = [523, 659, 784, 1047]; // C5, E5, G5, C6
            notes.forEach((freq, i) => {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.type = 'triangle';
                const t = ctx.currentTime + i * 0.12;
                osc.frequency.setValueAtTime(freq, t);
                gain.gain.setValueAtTime(0, t);
                gain.gain.linearRampToValueAtTime(0.15, t + 0.03);
                gain.gain.exponentialRampToValueAtTime(0.001, t + 0.3);
                osc.start(t);
                osc.stop(t + 0.3);
            });
        } catch(e) {}
    }

    function toggleMute() {
        isMuted = !isMuted;
        localStorage.setItem('bingo-muted', isMuted ? 'true' : 'false');
        updateMuteUI();
    }

    function updateMuteUI() {
        document.getElementById('muteIcon').innerHTML = isMuted ? '&#x1F507;' : '&#x1F50A;';
        document.getElementById('muteLabel').textContent = isMuted ? 'Muted' : 'Sound';
    }

    // ===== Initialize =====
    function init() {
        loadPreferences();
        applyTone();
        applyTheme();
        updateMuteUI();
        generateNewCard();
    }

    // ===== Preferences =====
    function loadPreferences() {
        const savedTone = localStorage.getItem('bingo-tone');
        if (savedTone === 'professional') {
            isFunMode = false;
            document.getElementById('toneToggle').checked = true;
        }

        const savedTheme = localStorage.getItem('bingo-theme');
        if (savedTheme === 'dark') {
            isDarkMode = true;
            document.getElementById('themeToggle').checked = true;
        } else if (savedTheme === null) {
            // Respect system preference
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                isDarkMode = true;
                document.getElementById('themeToggle').checked = true;
            }
        }

        const savedMute = localStorage.getItem('bingo-muted');
        if (savedMute === 'true') isMuted = true;
    }

    function saveTone() {
        localStorage.setItem('bingo-tone', isFunMode ? 'fun' : 'professional');
    }

    function saveTheme() {
        localStorage.setItem('bingo-theme', isDarkMode ? 'dark' : 'light');
    }

    // ===== Tone Toggle =====
    document.getElementById('toneToggle').addEventListener('change', function() {
        isFunMode = !this.checked;
        saveTone();
        applyTone();
    });

    function applyTone() {
        const titleEl = document.getElementById('mainTitle');
        const taglineEl = document.getElementById('tagline');
        const funLabel = document.getElementById('funLabel');
        const proLabel = document.getElementById('proLabel');
        const howTo = document.getElementById('howToPlay');

        if (isFunMode) {
            titleEl.textContent = 'AI Adoption Bullshit Bingo';
            taglineEl.textContent = "Spot the bullshit. Call it out. Win the meeting.";
            howTo.innerHTML = '<strong>Click</strong> a cell to mark the bullshit when you hear it. Hit the <strong>\u24D8</strong> for the comeback. Get <strong>5 in a row</strong> and call BINGO!';
            funLabel.classList.add('active');
            proLabel.classList.remove('active');
        } else {
            titleEl.textContent = 'AI Adoption Excuse Bingo';
            taglineEl.textContent = 'Identifying barriers to AI transformation, one meeting at a time';
            howTo.innerHTML = '<strong>Click</strong> a cell to mark it when you hear the excuse. Hit the <strong>\u24D8</strong> to see the rebuttal. Get <strong>5 in a row</strong> to win!';
            funLabel.classList.remove('active');
            proLabel.classList.add('active');
        }
    }

    // ===== Theme Toggle =====
    document.getElementById('themeToggle').addEventListener('change', function() {
        isDarkMode = this.checked;
        saveTheme();
        applyTheme();
    });

    function applyTheme() {
        document.documentElement.setAttribute('data-theme', isDarkMode ? 'dark' : '');
    }

    // ===== Card Generation =====
    function generateNewCard() {
        // Shuffle pool and pick 24
        const shuffled = [...EXCUSE_POOL].sort(() => Math.random() - 0.5);
        const selected = shuffled.slice(0, 24);

        // Insert free space at index 12 (center of 5x5)
        selected.splice(12, 0, {
            excuse: isFunMode ? "FREE\nBULLSHIT" : "FREE SPACE",
            rebuttal: "This one's free because the bullshit is guaranteed. Now get back to calling it out.",
            rebuttalPro: "This space is complimentary. Consider it a head start on your AI journey.",
            isFree: true
        });

        currentCard = selected;
        markedCells = new Set([12]); // Free space auto-marked
        bingoDetected = false;

        // Generate card seed for sharing
        cardSeed = Math.floor(Math.random() * 9000) + 1000;
        document.getElementById('cardId').textContent = `Card #${cardSeed}`;

        renderGrid();
        updateScore();
    }

    function renderGrid() {
        const grid = document.getElementById('bingoGrid');
        grid.innerHTML = '';

        currentCard.forEach((item, index) => {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.setAttribute('role', 'gridcell');
            cell.setAttribute('tabindex', '0');
            cell.setAttribute('aria-label', item.isFree ? 'Free space, auto-marked' : item.excuse);
            cell.setAttribute('aria-pressed', markedCells.has(index) ? 'true' : 'false');
            if (item.isFree) cell.classList.add('free-space');
            if (markedCells.has(index)) cell.classList.add('marked');

            const excuseSpan = document.createElement('span');
            excuseSpan.className = 'excuse-text';
            excuseSpan.textContent = item.excuse;

            const stampSpan = document.createElement('span');
            stampSpan.className = 'stamp-icon';
            stampSpan.innerHTML = '<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>';

            cell.appendChild(excuseSpan);
            cell.appendChild(stampSpan);

            // Info button for rebuttal (not on free space)
            if (!item.isFree) {
                const infoBtn = document.createElement('button');
                infoBtn.className = 'info-btn';
                infoBtn.setAttribute('aria-label', 'Show rebuttal for: ' + item.excuse);
                infoBtn.setAttribute('tabindex', '0');
                infoBtn.textContent = 'i';
                infoBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    showRebuttal(index);
                });
                cell.appendChild(infoBtn);
            }

            cell.dataset.index = index;

            // Click = mark/unmark (not on free space)
            cell.addEventListener('click', () => handleCellClick(index));

            // Keyboard: Enter/Space to mark, i to show info
            cell.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    handleCellClick(index);
                } else if (e.key === 'i' || e.key === 'I') {
                    e.preventDefault();
                    showRebuttal(index);
                }
            });

            grid.appendChild(cell);
        });
    }

    // ===== Cell Interaction =====
    function handleCellClick(index) {
        if (bingoDetected) return; // Game over - no more marking

        const item = currentCard[index];
        if (item.isFree) return; // Free space can't be toggled

        const cell = document.querySelector(`.cell[data-index="${index}"]`);

        if (markedCells.has(index)) {
            markedCells.delete(index);
            cell.classList.remove('marked');
            cell.setAttribute('aria-pressed', 'false');
            playUnmarkSound();
        } else {
            markedCells.add(index);
            cell.classList.add('marked');
            cell.setAttribute('aria-pressed', 'true');
            // Stamp animation
            cell.classList.remove('stamp-animate');
            void cell.offsetWidth; // Force reflow to restart animation
            cell.classList.add('stamp-animate');
            playStampSound();
        }

        updateScore();
        checkBingo();
    }

    // ===== Score =====
    function updateScore() {
        const count = markedCells.size;
        document.getElementById('scoreDisplay').textContent = isFunMode
            ? `${count} / 25 bullshit called`
            : `${count} / 25 marked`;
    }

    // ===== Rebuttal Modal =====
    function showRebuttal(index) {
        const item = currentCard[index];
        document.getElementById('rebuttalExcuse').textContent = item.excuse;
        const text = isFunMode ? item.rebuttal : (item.rebuttalPro || item.rebuttal);
        document.getElementById('rebuttalText').textContent = text;
        document.querySelector('.rebuttal-close').textContent = isFunMode ? "Called it!" : "Got it";
        document.getElementById('rebuttalOverlay').classList.add('show');
    }

    function closeRebuttal() {
        document.getElementById('rebuttalOverlay').classList.remove('show');
    }

    // Close on overlay click
    document.getElementById('rebuttalOverlay').addEventListener('click', function(e) {
        if (e.target === this) closeRebuttal();
    });

    // Close on Escape
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeRebuttal();
            closeBingo();
        }
    });

    // ===== Reset =====
    function resetMarks() {
        markedCells = new Set([12]); // Keep free space
        bingoDetected = false;
        document.querySelectorAll('.cell').forEach(cell => {
            const idx = parseInt(cell.dataset.index);
            cell.classList.toggle('marked', idx === 12);
            cell.classList.remove('bingo-cell');
        });
        updateScore();
    }

    // ===== Win Detection =====
    function checkBingo() {
        if (bingoDetected) return;

        const lines = [
            // Rows
            [0,1,2,3,4], [5,6,7,8,9], [10,11,12,13,14], [15,16,17,18,19], [20,21,22,23,24],
            // Columns
            [0,5,10,15,20], [1,6,11,16,21], [2,7,12,17,22], [3,8,13,18,23], [4,9,14,19,24],
            // Diagonals
            [0,6,12,18,24], [4,8,12,16,20]
        ];

        for (const line of lines) {
            if (line.every(i => markedCells.has(i))) {
                bingoDetected = true;
                // Highlight the winning line
                line.forEach(i => {
                    const cell = document.querySelector(`.cell[data-index="${i}"]`);
                    if (cell) cell.classList.add('bingo-cell');
                });
                showBingoCelebration();
                return;
            }
        }
    }

    // ===== BINGO Celebration =====
    function showBingoCelebration() {
        const titleEl = document.getElementById('bingoTitle');
        const subtitleEl = document.getElementById('bingoSubtitle');
        if (isFunMode) {
            titleEl.textContent = 'BULLSHIT BINGO!';
            subtitleEl.textContent = "That's a full line of bullshit! Congratulations, your meeting is officially pointless.";
        } else {
            titleEl.textContent = 'BINGO!';
            subtitleEl.textContent = "Five aligned barriers identified. A great opportunity for a focused discussion.";
        }
        document.getElementById('bingoOverlay').classList.add('show');
        playBingoSound();
        launchConfetti();
    }

    function closeBingo() {
        document.getElementById('bingoOverlay').classList.remove('show');
    }

    // ===== Confetti =====
    function launchConfetti() {
        const canvas = document.getElementById('confettiCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const colors = ['#BFD731', '#008AB0', '#0B2340', '#ffffff', '#FFD700', '#FF6B6B'];
        const particles = [];

        for (let i = 0; i < 150; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                w: Math.random() * 8 + 4,
                h: Math.random() * 4 + 2,
                color: colors[Math.floor(Math.random() * colors.length)],
                vx: (Math.random() - 0.5) * 4,
                vy: Math.random() * 3 + 2,
                rotation: Math.random() * 360,
                rotSpeed: (Math.random() - 0.5) * 10
            });
        }

        let frame = 0;
        const maxFrames = 180;

        function animate() {
            if (frame > maxFrames) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                return;
            }
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => {
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate((p.rotation * Math.PI) / 180);
                ctx.fillStyle = p.color;
                ctx.globalAlpha = Math.max(0, 1 - frame / maxFrames);
                ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
                ctx.restore();
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.05;
                p.rotation += p.rotSpeed;
            });
            frame++;
            requestAnimationFrame(animate);
        }

        animate();
    }

    // ===== Share Card (Canvas Screenshot) =====
    async function shareCard() {
        try {
            const canvas = document.createElement('canvas');
            const scale = 2;
            const cellSize = 100;
            const gap = 6;
            const padding = 24;
            const headerHeight = 60;
            const gridSize = cellSize * 5 + gap * 4;
            const totalW = gridSize + padding * 2;
            const totalH = gridSize + padding * 2 + headerHeight;

            canvas.width = totalW * scale;
            canvas.height = totalH * scale;
            const ctx = canvas.getContext('2d');
            ctx.scale(scale, scale);

            // Background
            ctx.fillStyle = isDarkMode ? '#1a2744' : '#ffffff';
            ctx.beginPath();
            ctx.roundRect(0, 0, totalW, totalH, 16);
            ctx.fill();

            // Header
            ctx.fillStyle = isDarkMode ? '#FAF9F6' : '#0B2340';
            ctx.font = 'bold 16px Barlow, sans-serif';
            ctx.textAlign = 'center';
            const title = isFunMode ? 'AI Adoption Bullshit Bingo' : 'AI Adoption Excuse Bingo';
            ctx.fillText(title, totalW / 2, 28);
            ctx.fillStyle = '#008AB0';
            ctx.font = '11px Barlow, sans-serif';
            const scoreLabel = isFunMode ? `${markedCells.size}/25 bullshit called` : `${markedCells.size}/25 marked`;
            ctx.fillText(`Card #${cardSeed}  \u2022  ${scoreLabel}`, totalW / 2, 48);

            // Draw cells
            for (let row = 0; row < 5; row++) {
                for (let col = 0; col < 5; col++) {
                    const idx = row * 5 + col;
                    const item = currentCard[idx];
                    const x = padding + col * (cellSize + gap);
                    const y = headerHeight + padding + row * (cellSize + gap);
                    const isMarked = markedCells.has(idx);

                    // Cell background
                    if (item.isFree || isMarked) {
                        ctx.fillStyle = isDarkMode ? '#4a6b0a' : '#BFD731';
                    } else {
                        ctx.fillStyle = isDarkMode ? '#1e2d4a' : '#ffffff';
                    }
                    ctx.beginPath();
                    ctx.roundRect(x, y, cellSize, cellSize, 6);
                    ctx.fill();

                    // Cell border
                    ctx.strokeStyle = isMarked || item.isFree
                        ? (isDarkMode ? '#4a6b0a' : '#BFD731')
                        : (isDarkMode ? '#2a3f66' : '#0B2340');
                    ctx.lineWidth = 1.5;
                    ctx.stroke();

                    // Checkmark for marked cells
                    if (isMarked && !item.isFree) {
                        ctx.fillStyle = isDarkMode ? 'rgba(250,249,246,0.2)' : 'rgba(11,35,64,0.15)';
                        ctx.font = 'bold 28px sans-serif';
                        ctx.textAlign = 'center';
                        ctx.fillText('\u2713', x + cellSize / 2, y + 30);
                    }

                    // Text
                    ctx.fillStyle = isMarked || item.isFree
                        ? (isDarkMode ? '#FAF9F6' : '#0B2340')
                        : (isDarkMode ? '#FAF9F6' : '#0B2340');
                    ctx.font = item.isFree ? 'bold 11px Barlow, sans-serif' : '9.5px Barlow, sans-serif';
                    ctx.textAlign = 'center';
                    wrapText(ctx, item.excuse, x + cellSize / 2, y + (item.isFree ? 46 : 36), cellSize - 12, 12);
                }
            }

            // Footer
            ctx.fillStyle = isDarkMode ? '#6b7280' : '#9ca3af';
            ctx.font = '9px Barlow, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Volaris Business Transformation', totalW / 2, totalH - 6);

            // Copy to clipboard
            const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
            if (navigator.clipboard && window.ClipboardItem) {
                await navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })]);
                showToast('Copied to clipboard!');
            } else {
                // Fallback: download
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `bingo-card-${cardSeed}.png`;
                a.click();
                URL.revokeObjectURL(url);
                showToast('Image downloaded!');
            }
        } catch (err) {
            console.error('Share failed:', err);
            showToast('Could not share card');
        }
    }

    function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
        const words = text.split(' ');
        let line = '';
        let lines = [];

        for (const word of words) {
            const test = line + (line ? ' ' : '') + word;
            if (ctx.measureText(test).width > maxWidth && line) {
                lines.push(line);
                line = word;
            } else {
                line = test;
            }
        }
        lines.push(line);

        // Center vertically
        const startY = y - ((lines.length - 1) * lineHeight) / 2;
        lines.forEach((l, i) => {
            ctx.fillText(l, x, startY + i * lineHeight);
        });
    }

    // ===== Toast =====
    function showToast(msg) {
        const toast = document.getElementById('toast');
        toast.textContent = msg;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 2000);
    }

    // ===== Start =====
    init();
    </script>
</body>
</html>
